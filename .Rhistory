# Chunk 12
summary(df$citric.acid)
# Chunk 13
ggplot(aes(x= residual.sugar), data= df)+
geom_histogram()
# Chunk 14
summary(df$residual.sugar)
# Chunk 15
ggplot(aes(x= chlorides), data= df)+
geom_histogram()
# Chunk 16
summary(df$chlorides)
# Chunk 17
ggplot(aes(x= free.sulfur.dioxide), data= df)+
geom_histogram()
# Chunk 18
ggplot(aes(x= total.sulfur.dioxide), data= df)+
geom_histogram()
# Chunk 19
summary(df$total.sulfur.dioxide)
# Chunk 20
ggplot(aes(x= density), data= df)+
geom_histogram()
# Chunk 21
ggplot(aes(x= pH), data= df)+
geom_histogram()
# Chunk 22
ggplot(aes(x= sulphates), data= df)+
geom_histogram()
# Chunk 23
summary(df$sulphates)
# Chunk 24
ggplot(aes(x= alcohol), data= df)+
geom_histogram()
# Chunk 25
summary(df$alcohol)
# Chunk 26
# make a new variable for rating based on the quality of red wines
df$rating = cut(df$quality,breaks = 3 , labels = c("bad", "average","good"))
summary(df$rating)
# Chunk 27
ggplot(aes(x= rating), data = df)+
geom_bar()
# Chunk 28
mydata <- df%>%
select(alcohol,volatile.acidity,citric.acid,residual.sugar,quality)
pairs.panels(mydata, scale=TRUE)
# Chunk 29: wider_plot
ggcorr(df[ , -c(1,15)], nbreaks=8, palette='RdGy', label=TRUE, label_size=5, label_color='white')
# Chunk 30
df$quality <- factor(df$quality, ordered = T)
ggplot(data = df, aes(x = quality, y = alcohol,fill = rating)) +
geom_boxplot() +
ggtitle('Alcohol in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Alcohol (% by volume)')
# Chunk 31
rating_alc <- df %>%
group_by(rating) %>%
summarise(alcohol_median = median(alcohol),
n=n())
rating_alc
# Chunk 32
ggplot(data = df, aes(x = quality, y = sulphates,fill = rating)) +
geom_boxplot() +
ggtitle('Sulphates in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Sulphates (potassium sulphate - g / dm3)')
# Chunk 33
rating_sulph <- df %>%
group_by(rating) %>%
summarise(sulphates_median = median(sulphates),
n=n())
rating_sulph
# Chunk 34
ggplot(data = df, aes(x = quality, y= volatile.acidity, fill= rating)) +
geom_boxplot()+
ggtitle('Volatile acidity in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Volatile acidity  (acetic acid - g / dm^3)')
# Chunk 35
rating_vol <- df %>%
group_by(rating) %>%
summarise(volatile_acidity_median = median(volatile.acidity),
n=n())
rating_vol
# Chunk 36
ggplot(data = df, aes(x = quality, y= fixed.acidity, fill= rating)) +
geom_boxplot()+
ggtitle('Fixed acidity in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Fixed acidity  (tartaric acid - g / dm^3)')
# Chunk 37
ggplot(data = df, aes(x = quality, y= citric.acid, fill= rating)) +
geom_boxplot()+
ggtitle('Citric acid in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Citric acid  (g / dm^3)')
# Chunk 38
ggplot(data = df, aes(x = quality, y= residual.sugar, fill= rating)) +
geom_boxplot()+
ggtitle('Residual Sugar in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Residual Sugar (g / dm^3)')
# Chunk 39
ggplot(data = df, aes(x = quality, y= chlorides, fill= rating)) +
geom_boxplot()+
ggtitle('Chlorides in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Chlorides (sodium chloride - g / dm^3)')
# Chunk 40
rating_chlor <- df %>%
group_by(rating) %>%
summarise(chlorides_median = median(chlorides),
n=n())
rating_chlor
# Chunk 41
ggplot(data = df, aes(x = quality, y= free.sulfur.dioxide, fill= rating)) +
geom_boxplot() +
ggtitle('Free SO2 in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Free SO2 (mg / dm^3)')
# Chunk 42
ggplot(data = df, aes(x = quality, y= total.sulfur.dioxide, fill= rating)) +
geom_boxplot() +
ggtitle('Total SO2 in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Total SO2 (mg / dm^3)')
# Chunk 43
ggplot(data = df, aes(x = quality, y= density, fill= rating)) +
geom_boxplot() +
ggtitle('Density in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Density (g / cm^3)')
# Chunk 44
ggplot(data = df, aes(x = quality, y= pH,fill= rating)) +
geom_boxplot() +
ggtitle('pH in Different Red Wine Qualities') +
xlab('Quality') +
ylab('pH')
# Chunk 45
p1 <- ggplot(aes(x = pH, y = fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p2 <- ggplot(aes(x = pH, y = citric.acid), data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p3 <- ggplot(aes(x = pH, y = volatile.acidity), data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
p4 <- ggplot(aes(x=citric.acid, y= volatile.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p5 <- ggplot(aes(x=citric.acid, y= fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
p6 <- ggplot(aes(x= density, y = fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
grid.arrange(p1 , p2, p3, p4, p5, p6, ncol=3)
# Chunk 46
ggplot(aes(x= quality, y = alcohol ),
data = subset(df, rating != 'avearge'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= mean)
ggplot(aes(x= quality, y = alcohol ),
data = subset(df, rating != 'avearge'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality, y = alcohol ),
data = df)+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality, y = alcohol ),
data = df)+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= alcohol, y =  quality),
data = df)+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = df)+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
df %>%
group_by(qaulity, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
df %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
ggplot(aes(x= quality , y =  alcohol),
data = df)+
geom_bar(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = df)+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != average))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
df %>%
select(rating != 'average')
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
df %>%
select(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
df %>%
select(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
df %>%
filter(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n())
df %>%
filter(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n()) %>%
ungroup() %>%
arrange(quality)
ggplot(aes(x= alcohol , y =  quality),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= alcohol , y =  quality),
data = subset(df, rating != 'average'))+
geom_line(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= fixed.acidity , y =  pH),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= fixed.acidity , y =  pH),
data = subset(df, rating != 'average'))+
geom_line(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= fixed.acidity , y =  pH),
data = df)+
geom_line(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  fixed.acidity),
data = df)+
geom_line(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  fixed.acidity),
data = df)+
geom_point(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  fixed.acidity),
data = df)+
geom_point(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= fixed.acidity , y =  pH),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  fixed.acidity),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_line(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= alcohol , y =  pH),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
ggplot(aes(x= pH , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
df %>%
filter(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n()) %>%
ungroup() %>%
arrange(quality)
View(df)
df %>%
filter(rating != 'average') %>%
group_by(quality, rating) %>%
summarise(mean_alc = mean(alcohol),
median_alc= median(alcohol),
n= n()) %>%
ungroup() %>%
arrange(quality)
# Chunk 1
getwd()
# Chunk 2: setup
knitr::opts_chunk$set(echo = FALSE ,message=FALSE, warning=FALSE)
# Chunk 3
library(ggplot2)
library(psych)
library(dplyr)
library(GGally)
library(gridExtra)
# Chunk 4
df <- read.csv("wineQualityReds.csv")
dim(df)
# Chunk 5
str(df)
# Chunk 6
summary(df)
# Chunk 7
ggplot(aes(x= quality), data= df)+
geom_histogram(stat = 'count')+
scale_x_continuous(breaks = seq(0,10,1))
# Chunk 8
ggplot(aes(x= fixed.acidity), data= df)+
geom_histogram()
# Chunk 9
summary(df$fixed.acidity)
# Chunk 10
ggplot(aes(x= volatile.acidity), data= df)+
geom_histogram()
# Chunk 11
ggplot(aes(x= citric.acid), data= df)+
geom_histogram()
# Chunk 12
summary(df$citric.acid)
# Chunk 13
ggplot(aes(x= residual.sugar), data= df)+
geom_histogram()
# Chunk 14
summary(df$residual.sugar)
# Chunk 15
ggplot(aes(x= chlorides), data= df)+
geom_histogram()
# Chunk 16
summary(df$chlorides)
# Chunk 17
ggplot(aes(x= free.sulfur.dioxide), data= df)+
geom_histogram()
# Chunk 18
ggplot(aes(x= total.sulfur.dioxide), data= df)+
geom_histogram()
# Chunk 19
summary(df$total.sulfur.dioxide)
# Chunk 20
ggplot(aes(x= density), data= df)+
geom_histogram()
# Chunk 21
ggplot(aes(x= pH), data= df)+
geom_histogram()
# Chunk 22
ggplot(aes(x= sulphates), data= df)+
geom_histogram()
# Chunk 23
summary(df$sulphates)
# Chunk 24
ggplot(aes(x= alcohol), data= df)+
geom_histogram()
# Chunk 25
summary(df$alcohol)
# Chunk 26
# make a new variable for rating based on the quality of red wines
df$rating = cut(df$quality,breaks = 3 , labels = c("bad", "average","good"))
summary(df$rating)
# Chunk 27
ggplot(aes(x= rating), data = df)+
geom_bar()
# Chunk 28
mydata <- df%>%
select(alcohol,volatile.acidity,citric.acid,residual.sugar,quality)
pairs.panels(mydata, scale=TRUE)
# Chunk 29: wider_plot
ggcorr(df[ , -c(1,15)], nbreaks=8, palette='RdGy', label=TRUE, label_size=5, label_color='white')
# Chunk 30
df$quality <- factor(df$quality, ordered = T)
ggplot(data = df, aes(x = quality, y = alcohol,fill = rating)) +
geom_boxplot() +
ggtitle('Alcohol in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Alcohol (% by volume)')
# Chunk 31
rating_alc <- df %>%
group_by(rating) %>%
summarise(alcohol_median = median(alcohol),
n=n())
rating_alc
# Chunk 32
ggplot(data = df, aes(x = quality, y = sulphates,fill = rating)) +
geom_boxplot() +
ggtitle('Sulphates in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Sulphates (potassium sulphate - g / dm3)')
# Chunk 33
rating_sulph <- df %>%
group_by(rating) %>%
summarise(sulphates_median = median(sulphates),
n=n())
rating_sulph
# Chunk 34
ggplot(data = df, aes(x = quality, y= volatile.acidity, fill= rating)) +
geom_boxplot()+
ggtitle('Volatile acidity in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Volatile acidity  (acetic acid - g / dm^3)')
# Chunk 35
rating_vol <- df %>%
group_by(rating) %>%
summarise(volatile_acidity_median = median(volatile.acidity),
n=n())
rating_vol
# Chunk 36
ggplot(data = df, aes(x = quality, y= fixed.acidity, fill= rating)) +
geom_boxplot()+
ggtitle('Fixed acidity in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Fixed acidity  (tartaric acid - g / dm^3)')
# Chunk 37
ggplot(data = df, aes(x = quality, y= citric.acid, fill= rating)) +
geom_boxplot()+
ggtitle('Citric acid in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Citric acid  (g / dm^3)')
# Chunk 38
ggplot(data = df, aes(x = quality, y= residual.sugar, fill= rating)) +
geom_boxplot()+
ggtitle('Residual Sugar in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Residual Sugar (g / dm^3)')
# Chunk 39
ggplot(data = df, aes(x = quality, y= chlorides, fill= rating)) +
geom_boxplot()+
ggtitle('Chlorides in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Chlorides (sodium chloride - g / dm^3)')
# Chunk 40
rating_chlor <- df %>%
group_by(rating) %>%
summarise(chlorides_median = median(chlorides),
n=n())
rating_chlor
# Chunk 41
ggplot(data = df, aes(x = quality, y= free.sulfur.dioxide, fill= rating)) +
geom_boxplot() +
ggtitle('Free SO2 in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Free SO2 (mg / dm^3)')
# Chunk 42
ggplot(data = df, aes(x = quality, y= total.sulfur.dioxide, fill= rating)) +
geom_boxplot() +
ggtitle('Total SO2 in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Total SO2 (mg / dm^3)')
# Chunk 43
ggplot(data = df, aes(x = quality, y= density, fill= rating)) +
geom_boxplot() +
ggtitle('Density in Different Red Wine Qualities') +
xlab('Quality') +
ylab('Density (g / cm^3)')
# Chunk 44
ggplot(data = df, aes(x = quality, y= pH,fill= rating)) +
geom_boxplot() +
ggtitle('pH in Different Red Wine Qualities') +
xlab('Quality') +
ylab('pH')
# Chunk 45
p1 <- ggplot(aes(x = pH, y = fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p2 <- ggplot(aes(x = pH, y = citric.acid), data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p3 <- ggplot(aes(x = pH, y = volatile.acidity), data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
p4 <- ggplot(aes(x=citric.acid, y= volatile.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='purple')
p5 <- ggplot(aes(x=citric.acid, y= fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
p6 <- ggplot(aes(x= density, y = fixed.acidity),data=df)+
geom_point(alpha= 0.1, position = position_jitter(h=0))+
geom_smooth(method ='lm', color='orange')
grid.arrange(p1 , p2, p3, p4, p5, p6, ncol=3)
# Chunk 46
# Chunk 47
ggplot(aes(x= quality , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_bar(aes(fill = rating), stat = 'summary', fun.y= median)
# Chunk 48
ggplot(aes(x= pH , y =  alcohol),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
# Chunk 49
ggplot(aes(x= pH , y =  fixed.acidity),
data = subset(df, rating != 'average'))+
geom_line(aes(color = rating), stat = 'summary', fun.y= median)
